@page "/login"
@using Infrastructure.Models
@using Microsoft.AspNetCore.Identity
@inject SignInManager<ApplicationUser> SignInManager
@inject NavigationManager Nav

<MudPaper Width="400px" Class="mx-auto mt-10 pa-6">
    <MudText Typo="Typo.h5">Login</MudText>

    <MudTextField @bind-Value="email" Label="Email" />
    <MudTextField @bind-Value="password"
                  Label="Password"
                  InputType="InputType.Password" />

    <MudButton OnClick="LoginLogic"
               Color="Color.Primary">
        Login
    </MudButton>
</MudPaper>

@code {
    string email = "";
    string password = "";

    async Task LoginLogic()
    {
        var result = await SignInManager.PasswordSignInAsync(
            email,
            password,
            isPersistent: true,
            lockoutOnFailure: false);

        if (result.Succeeded)
            Nav.NavigateTo("/");
    }
}
